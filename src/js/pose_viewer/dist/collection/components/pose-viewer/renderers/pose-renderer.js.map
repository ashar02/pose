{"version":3,"file":"pose-renderer.js","sourceRoot":"","sources":["../../../../src/components/pose-viewer/renderers/pose-renderer.tsx"],"names":[],"mappings":"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","sourcesContent":["import {PoseViewer} from \"../pose-viewer\";\nimport {PoseBodyFrameModel, PoseLimb, PosePointModel, RGBColor} from \"pose-format\";\n\nexport abstract class PoseRenderer {\n\n  constructor(protected viewer: PoseViewer) {\n  }\n\n  x(v: number) {\n    const n = v * (this.viewer.elWidth - 2 * this.viewer.elPadding.width);\n    return n / this.viewer.pose.header.width + this.viewer.elPadding.width;\n  }\n\n  y(v: number) {\n    const n = v * (this.viewer.elHeight - 2 * this.viewer.elPadding.height);\n    return n / this.viewer.pose.header.height + this.viewer.elPadding.height;\n  }\n\n  isJointValid(joint: PosePointModel) {\n    return joint.C > 0;\n  }\n\n  abstract renderJoint(i: number, joint: PosePointModel, color: RGBColor);\n\n  renderJoints(joints: PosePointModel[], colors: RGBColor[]) {\n    return joints\n      .filter(this.isJointValid.bind(this))\n      .map((joint, i) => {\n        return this.renderJoint(i, joint, colors[i % colors.length]);\n      });\n  }\n\n  abstract renderLimb(from: PosePointModel, to: PosePointModel, color: RGBColor);\n\n  renderLimbs(limbs: PoseLimb[], joints: PosePointModel[], colors: RGBColor[]) {\n    return limbs.map(({from, to}) => {\n      const a = joints[from];\n      const b = joints[to];\n      if (!this.isJointValid(a) || !this.isJointValid(b)) {\n        return \"\";\n      }\n\n      const c1 = colors[from % colors.length];\n      const c2 = colors[to % colors.length];\n      const color = {\n        R: (c1.R + c2.R) / 2,\n        G: (c1.G + c2.G) / 2,\n        B: (c1.B + c2.B) / 2,\n      };\n\n      return this.renderLimb(a, b, color);\n    });\n  }\n\n  renderFrame(frame: PoseBodyFrameModel) {\n    return frame.people.map(person => this.viewer.pose.header.components.map(component => {\n      const joints = person[component.name];\n      return [\n        this.renderJoints(joints, component.colors),\n        this.renderLimbs(component.limbs, joints, component.colors),\n      ]\n    }))\n  }\n\n  abstract render(frame: PoseBodyFrameModel);\n}\n"]}